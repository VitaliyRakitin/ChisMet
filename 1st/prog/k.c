//
//  k.c
//  
//
//  Created by Виталий Ракитин on 26.09.15.
//

#include "task1.h"
// исходные функции
double  f1(double x, double y, double u, double v){
    //return u;
    return y;
}

double  f2(double x, double y, double u, double v){
    //return v;
    return -x;
}

double  f3(double x, double y, double u, double v){
    //return y * (2 - x * x - y * y);
    return 0;
}

double  f4(double x, double y, double u, double v){
   //return -x * (2 - x * x - y * y);
   return 0;
}

void new_k(double h, double  k[K_NUM][VAL_NUM], double x, double y, double u, double  v){

  k[0][0] = h * f1(x,y,u,v);
  k[0][1] = h * f2(x,y,u,v);
  k[0][2] = h * f3(x,y,u,v);
  k[0][3] = h * f4(x,y,u,v);
  
  k[1][0] = h * f1( x + b21 * k[0][0], 
                    y + b21 * k[0][1], 
                    u + b21 * k[0][2], 
                    v + b21 * k[0][3]);

  k[1][1] = h * f2( x + b21 * k[0][0], 
                    y + b21 * k[0][1], 
                    u + b21 * k[0][2], 
                    v + b21 * k[0][3]);

  k[1][2] = h * f3( x + b21 * k[0][0], 
                    y + b21 * k[0][1], 
                    u + b21 * k[0][2], 
                    v + b21 * k[0][3]);

  k[1][3] = h * f4( x + b21 * k[0][0], 
                    y + b21 * k[0][1], 
                    u + b21 * k[0][2], 
                    v + b21 * k[0][3]);

  k[2][0] = h * f1( x + b31 * k[0][0] + b32 * k[1][0],
                    y + b31 * k[0][1] + b32 * k[1][1],
                    u + b31 * k[0][2] + b32 * k[1][2],
                    v + b31 * k[0][3] + b32 * k[1][3]);

  k[2][1] = h * f2( x + b31 * k[0][0] + b32 * k[1][0],
                    y + b31 * k[0][1] + b32 * k[1][1],
                    u + b31 * k[0][2] + b32 * k[1][2],
                    v + b31 * k[0][3] + b32 * k[1][3]);

  k[2][2] = h * f3( x + b31 * k[0][0] + b32 * k[1][0],
                    y + b31 * k[0][1] + b32 * k[1][1],
                    u + b31 * k[0][2] + b32 * k[1][2],
                    v + b31 * k[0][3] + b32 * k[1][3]);

  k[2][3] = h * f4( x + b31 * k[0][0] + b32 * k[1][0],
                    y + b31 * k[0][1] + b32 * k[1][1],
                    u + b31 * k[0][2] + b32 * k[1][2],
                    v + b31 * k[0][3] + b32 * k[1][3]);

  k[3][0] = h * f1( x + b41 * k[0][0] + b42 * k[1][0] + b43 * k[2][0],
                    y + b41 * k[0][1] + b42 * k[1][1] + b43 * k[2][1],
                    u + b41 * k[0][2] + b42 * k[1][2] + b43 * k[2][2],
                    v + b41 * k[0][3] + b42 * k[1][3] + b43 * k[2][3]);

  k[3][1] = h * f2( x + b41 * k[0][0] + b42 * k[1][0] + b43 * k[2][0],
                    y + b41 * k[0][1] + b42 * k[1][1] + b43 * k[2][1],
                    u + b41 * k[0][2] + b42 * k[1][2] + b43 * k[2][2],
                    v + b41 * k[0][3] + b42 * k[1][3] + b43 * k[2][3]);

  k[3][2] = h * f3( x + b41 * k[0][0] + b42 * k[1][0] + b43 * k[2][0],
                    y + b41 * k[0][1] + b42 * k[1][1] + b43 * k[2][1],
                    u + b41 * k[0][2] + b42 * k[1][2] + b43 * k[2][2],
                    v + b41 * k[0][3] + b42 * k[1][3] + b43 * k[2][3]);

  k[3][3] = h * f4( x + b41 * k[0][0] + b42 * k[1][0] + b43 * k[2][0],
                    y + b41 * k[0][1] + b42 * k[1][1] + b43 * k[2][1],
                    u + b41 * k[0][2] + b42 * k[1][2] + b43 * k[2][2],
                    v + b41 * k[0][3] + b42 * k[1][3] + b43 * k[2][3]);

  k[4][0] = h * f1( x + b51 * k[0][0] + b52 * k[1][0] + b53 * k[2][0] + b54 * k[3][0],
                    y + b51 * k[0][1] + b52 * k[1][1] + b53 * k[2][1] + b54 * k[3][1],
                    u + b51 * k[0][2] + b52 * k[1][2] + b53 * k[2][2] + b54 * k[3][2],
                    v + b51 * k[0][3] + b52 * k[1][3] + b53 * k[2][3] + b54 * k[3][3]);

  k[4][1] = h * f2( x + b51 * k[0][0] + b52 * k[1][0] + b53 * k[2][0] + b54 * k[3][0],
                    y + b51 * k[0][1] + b52 * k[1][1] + b53 * k[2][1] + b54 * k[3][1],
                    u + b51 * k[0][2] + b52 * k[1][2] + b53 * k[2][2] + b54 * k[3][2],
                    v + b51 * k[0][3] + b52 * k[1][3] + b53 * k[2][3] + b54 * k[3][3]);

  k[4][2] = h * f3( x + b51 * k[0][0] + b52 * k[1][0] + b53 * k[2][0] + b54 * k[3][0],
                    y + b51 * k[0][1] + b52 * k[1][1] + b53 * k[2][1] + b54 * k[3][1],
                    u + b51 * k[0][2] + b52 * k[1][2] + b53 * k[2][2] + b54 * k[3][2],
                    v + b51 * k[0][3] + b52 * k[1][3] + b53 * k[2][3] + b54 * k[3][3]);

  k[4][3] = h * f4( x + b51 * k[0][0] + b52 * k[1][0] + b53 * k[2][0] + b54 * k[3][0],
                    y + b51 * k[0][1] + b52 * k[1][1] + b53 * k[2][1] + b54 * k[3][1],
                    u + b51 * k[0][2] + b52 * k[1][2] + b53 * k[2][2] + b54 * k[3][2],
                    v + b51 * k[0][3] + b52 * k[1][3] + b53 * k[2][3] + b54 * k[3][3]);

  k[5][0] = h * f1( x + b61 * k[0][0] + b62 * k[1][0] + b63 * k[2][0] + b64 * k[3][0] + b65 * k[4][0],
                    y + b61 * k[0][1] + b62 * k[1][1] + b63 * k[2][1] + b64 * k[3][1] + b65 * k[4][1],
                    u + b61 * k[0][2] + b62 * k[1][2] + b63 * k[2][2] + b64 * k[3][2] + b65 * k[4][2],
                    v + b61 * k[0][3] + b62 * k[1][3] + b63 * k[2][3] + b64 * k[3][3] + b65 * k[4][3]);

  k[5][1] = h * f2( x + b61 * k[0][0] + b62 * k[1][0] + b63 * k[2][0] + b64 * k[3][0] + b65 * k[4][0],
                    y + b61 * k[0][1] + b62 * k[1][1] + b63 * k[2][1] + b64 * k[3][1] + b65 * k[4][1],
                    u + b61 * k[0][2] + b62 * k[1][2] + b63 * k[2][2] + b64 * k[3][2] + b65 * k[4][2],
                    v + b61 * k[0][3] + b62 * k[1][3] + b63 * k[2][3] + b64 * k[3][3] + b65 * k[4][3]);

  k[5][2] = h * f3( x + b61 * k[0][0] + b62 * k[1][0] + b63 * k[2][0] + b64 * k[3][0] + b65 * k[4][0],
                    y + b61 * k[0][1] + b62 * k[1][1] + b63 * k[2][1] + b64 * k[3][1] + b65 * k[4][1],
                    u + b61 * k[0][2] + b62 * k[1][2] + b63 * k[2][2] + b64 * k[3][2] + b65 * k[4][2],
                    v + b61 * k[0][3] + b62 * k[1][3] + b63 * k[2][3] + b64 * k[3][3] + b65 * k[4][3]);

  k[5][3] = h * f4( x + b61 * k[0][0] + b62 * k[1][0] + b63 * k[2][0] + b64 * k[3][0] + b65 * k[4][0],
                    y + b61 * k[0][1] + b62 * k[1][1] + b63 * k[2][1] + b64 * k[3][1] + b65 * k[4][1],
                    u + b61 * k[0][2] + b62 * k[1][2] + b63 * k[2][2] + b64 * k[3][2] + b65 * k[4][2],
                    v + b61 * k[0][3] + b62 * k[1][3] + b63 * k[2][3] + b64 * k[3][3] + b65 * k[4][3]);

  k[6][0] = h * f1( x + b71 * k[0][0] + b72 * k[1][0] + b73 * k[2][0] + b74 * k[3][0] + b75 * k[4][0] + b76 * k[5][0],
                    y + b71 * k[0][1] + b72 * k[1][1] + b73 * k[2][1] + b74 * k[3][1] + b75 * k[4][1] + b76 * k[5][1],
                    u + b71 * k[0][2] + b72 * k[1][2] + b73 * k[2][2] + b74 * k[3][2] + b75 * k[4][2] + b76 * k[5][2],
                    v + b71 * k[0][3] + b72 * k[1][3] + b73 * k[2][3] + b74 * k[3][3] + b75 * k[4][3] + b76 * k[5][3]);

  k[6][1] = h * f2( x + b71 * k[0][0] + b72 * k[1][0] + b73 * k[2][0] + b74 * k[3][0] + b75 * k[4][0] + b76 * k[5][0],
                    y + b71 * k[0][1] + b72 * k[1][1] + b73 * k[2][1] + b74 * k[3][1] + b75 * k[4][1] + b76 * k[5][1],
                    u + b71 * k[0][2] + b72 * k[1][2] + b73 * k[2][2] + b74 * k[3][2] + b75 * k[4][2] + b76 * k[5][2],
                    v + b71 * k[0][3] + b72 * k[1][3] + b73 * k[2][3] + b74 * k[3][3] + b75 * k[4][3] + b76 * k[5][3]);

  k[6][2] = h * f3( x + b71 * k[0][0] + b72 * k[1][0] + b73 * k[2][0] + b74 * k[3][0] + b75 * k[4][0] + b76 * k[5][0],
                    y + b71 * k[0][1] + b72 * k[1][1] + b73 * k[2][1] + b74 * k[3][1] + b75 * k[4][1] + b76 * k[5][1],
                    u + b71 * k[0][2] + b72 * k[1][2] + b73 * k[2][2] + b74 * k[3][2] + b75 * k[4][2] + b76 * k[5][2],
                    v + b71 * k[0][3] + b72 * k[1][3] + b73 * k[2][3] + b74 * k[3][3] + b75 * k[4][3] + b76 * k[5][3]);

  k[6][3] = h * f4( x + b71 * k[0][0] + b72 * k[1][0] + b73 * k[2][0] + b74 * k[3][0] + b75 * k[4][0] + b76 * k[5][0],
                    y + b71 * k[0][1] + b72 * k[1][1] + b73 * k[2][1] + b74 * k[3][1] + b75 * k[4][1] + b76 * k[5][1],
                    u + b71 * k[0][2] + b72 * k[1][2] + b73 * k[2][2] + b74 * k[3][2] + b75 * k[4][2] + b76 * k[5][2],
                    v + b71 * k[0][3] + b72 * k[1][3] + b73 * k[2][3] + b74 * k[3][3] + b75 * k[4][3] + b76 * k[5][3]);

for (int j=0;j<1;j++)
  printf("%e %e %e %e %e %e %e ", k[0][j],k[1][j],k[2][j],k[3][j],k[4][j],k[5][j],k[6][j]);
 printf("\n");
  return;
}
